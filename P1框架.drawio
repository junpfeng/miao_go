<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36" version="29.2.9">
  <diagram name="第 1 页" id="S1icYzySiZ6NtbNd02j9">
    <mxGraphModel dx="3064" dy="1154" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="YhBxXAwAqzDYDqpHPoga-2" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="获取player" vertex="1">
          <mxGeometry height="30" width="60" x="10" y="10" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-3" parent="1" style="text;whiteSpace=wrap;" value="common.GetResourceAs[*resource.PlayerManager](s.Scene(), common.ResourceType_PlayerManager)" vertex="1">
          <mxGeometry height="30" width="560" x="10" y="50" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-4" parent="1" style="text;whiteSpace=wrap;" value="townMgr, ok := common.GetResourceAs[*resource.TownMgr](s.Scene(), common.ResourceType_TownMgr)" vertex="1">
          <mxGeometry height="30" width="600" x="10" y="100" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-5" parent="1" style="text;whiteSpace=wrap;" value="snapShorMgr, ok := common.GetResourceAs[*resource.SnapshotMgr](s.Scene(), common.ResourceType_SnapshotMgr)" vertex="1">
          <mxGeometry height="30" width="650" x="10" y="150" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-6" parent="1" style="text;whiteSpace=wrap;" value="var _ common.Scene = (*scene)(nil)" vertex="1">
          <mxGeometry height="30" width="200" x="10" y="200" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-7" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="&lt;ol style=&quot;box-sizing: border-box; margin: 0px 0px 12px; list-style-position: initial; list-style-image: initial; padding: 0px 0px 0px 18px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; font-size: 13px; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;&lt;li style=&quot;box-sizing: border-box; margin-bottom: 4px;&quot;&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;Component（组件）&lt;/strong&gt;：负责存储数据和提供对该数据的基本操作方法。例如&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;TownInventoryComp&lt;/code&gt;&amp;nbsp;组件存储背包数据并提供操作背包的方法，如&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;SplitItem&lt;/code&gt;&amp;nbsp;、&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;MoveItem&lt;/code&gt;&amp;nbsp;等。&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;box-sizing: border-box; margin-bottom: 4px;&quot;&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;System（系统）&lt;/strong&gt;：负责处理逻辑、协调组件之间的交互，并在每个tick周期中执行特定的更新逻辑。系统本身不存储数据，而是操作组件中的数据。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;" vertex="1">
          <mxGeometry height="60" width="750" x="30" y="330" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-8" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="&lt;p style=&quot;box-sizing: border-box; margin: 0px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; font-size: 13px; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;从代码中可以看出，System的主要职责包括：&lt;/p&gt;&lt;ul style=&quot;box-sizing: border-box; margin: 0px 0px 12px; list-style-position: initial; list-style-image: initial; padding: 0px 0px 0px 18px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; font-size: 13px; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;&lt;li style=&quot;box-sizing: border-box; margin-bottom: 4px;&quot;&gt;在每个tick周期中执行特定逻辑（通过&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;Update()&lt;/code&gt;&amp;nbsp;方法）&lt;/li&gt;&lt;li style=&quot;box-sizing: border-box; margin-bottom: 4px;&quot;&gt;处理消息（通过&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;OnMsg()&lt;/code&gt;&amp;nbsp;和&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;OnRpc()&lt;/code&gt;&amp;nbsp;方法）&lt;/li&gt;&lt;li style=&quot;box-sizing: border-box; margin-bottom: 4px;&quot;&gt;在tick开始和结束时执行特定逻辑（通过&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;OnBeforeTick()&lt;/code&gt;&amp;nbsp;和&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;OnAfterTick()&lt;/code&gt;&amp;nbsp;方法）&lt;/li&gt;&lt;li style=&quot;box-sizing: border-box; margin-bottom: 4px;&quot;&gt;系统销毁时清理资源（通过&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;OnDestroy()&lt;/code&gt;&amp;nbsp;方法）&lt;/li&gt;&lt;/ul&gt;" vertex="1">
          <mxGeometry height="120" width="650" x="50" y="420" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-9" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="&lt;h2 style=&quot;box-sizing: border-box; font-size: 13px; margin-block: 0px 4px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;如果确实需要添加System，如何添加&lt;/h2&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; font-size: 13px; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;如果将来需要添加System（例如实现定期检查物品过期功能），可以按以下步骤添加：&lt;/p&gt;&lt;ol style=&quot;box-sizing: border-box; margin: 0px 0px 12px; list-style-position: initial; list-style-image: initial; padding: 0px 0px 0px 18px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; font-size: 13px; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;&lt;li style=&quot;box-sizing: border-box; margin-bottom: 4px;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;在&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;common/ecs.go&lt;/code&gt;&amp;nbsp;中添加新的System类型&lt;/strong&gt;：&lt;/li&gt;&lt;/ol&gt;&lt;div class=&quot;markdown-pre-container&quot; style=&quot;box-sizing: border-box; border-color: color(srgb 0.8 0.8 0.8 / 0.12); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; margin-block: 12px; border-radius: 4px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; font-size: 13px; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;&lt;div class=&quot;markdown-pre__header&quot; style=&quot;box-sizing: border-box; background-color: rgb(30, 30, 30); align-items: center; border-radius: 4px 4px 0px 0px; display: flex; gap: 8px; justify-content: space-between; padding: 6px 12px; position: sticky; top: 0px; z-index: 1;&quot;&gt;&lt;span class=&quot;markdown-pre__title&quot; style=&quot;box-sizing: border-box; color: rgb(255, 255, 255); font-size: 12px; font-weight: 600; height: 18px; line-height: 18px; text-transform: capitalize;&quot;&gt;go&lt;/span&gt;&lt;div class=&quot;markdown-pre__actions&quot; style=&quot;box-sizing: border-box; align-items: center; color: rgb(204, 204, 204); display: flex; gap: 8px; line-height: 20px; overflow-x: hidden;&quot;&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;插入至光标处&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M4.73486 6.62196L6.11235 7.99945L4.73486 9.37693&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M6 8L1 8&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;rect x=&quot;6&quot; y=&quot;2&quot; width=&quot;8&quot; height=&quot;3&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/rect&gt;&lt;rect x=&quot;6&quot; y=&quot;11&quot; width=&quot;8&quot; height=&quot;3&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/rect&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;插入&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;复制&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M4.5 11.5C4.5 12.0523 4.94772 12.5 5.5 12.5H12C12.5523 12.5 13 12.0523 13 11.5V6.99299C13 6.44071 12.5523 5.99299 12 5.99299H9.9324C9.38012 5.99299 8.9324 5.54528 8.9324 4.99299V3C8.9324 2.44771 8.48469 2 7.9324 2H5.5C4.94772 2 4.5 2.44772 4.5 3V11.5Z&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M8.5293 2.19629L12.6563 6.22913&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M2.5 6.5V11.5C2.5 13.1569 3.84315 14.5 5.5 14.5H9.5&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;复制&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;新建文件&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M13 7.7V5L10.1875 2H3.625C3.27982 2 3 2.26863 3 2.6V13.4C3 13.7314 3.27982 14 3.625 14H7.375&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M9.4165 2V5.00011H12.9999&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.2085 9.5V14&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M13.4585 11.75L8.9585 11.75&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;新建文件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;保存到本地&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M13 7.7V5L10.1875 2H3.625C3.27982 2 3 2.26863 3 2.6V13.4C3 13.7314 3.27982 14 3.625 14H7.375&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M9.4165 2V5.00011H12.9999&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.2085 9.5V14&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.209 14L9.31982 12.1108&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.209 14L13.0981 12.1108&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;保存&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__divider&quot; style=&quot;box-sizing: border-box; border-left: 0.8px solid rgb(96, 96, 96); height: 16px; margin-left: 4px; padding-left: 4px;&quot;&gt;&lt;/div&gt;&lt;div title=&quot;应用代码&quot; class=&quot;markdown-pre__action&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M6.34856 4.97077C6.41299 4.79665 6.65927 4.79664 6.7237 4.97077L7.88659 8.11341L11.0292 9.2763C11.2034 9.34073 11.2034 9.58701 11.0292 9.65144L7.88659 10.8143L6.7237 13.957C6.65927 14.1311 6.41299 14.1311 6.34856 13.957L5.18568 10.8143L2.04303 9.65144C1.86891 9.58701 1.86891 9.34073 2.04303 9.2763L5.18568 8.11341L6.34856 4.97077Z&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M12.2662 1.53613L12.8599 3.14038L14.4641 3.73401L12.8599 4.32763L12.2662 5.93188L11.6726 4.32763L10.0684 3.73401L11.6726 3.14038L12.2662 1.53613Z&quot; fill=&quot;currentColor&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;0.975&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;应用代码&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M4.66663 13.333L7.99996 9.99967L11.3333 13.333&quot; stroke=&quot;currentColor&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M4.66663 2.66667L7.99996 6L11.3333 2.66667&quot; stroke=&quot;currentColor&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;pre class=&quot;markdown-pre has-scrollbar&quot; style=&quot;box-sizing: border-box; scrollbar-color: rgba(121, 121, 121, 0.4) rgba(0, 0, 0, 0); scrollbar-width: thin; border-top: none; margin: 0px; overflow: auto; --mermaid-block-height: 360px; border-radius: 0px 0px 4px 4px;&quot;&gt;&lt;code class=&quot;hljs language-go&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; color: rgb(201, 209, 217); background-color: inherit; padding: 6px 12px; border-radius: 0px; box-sizing: border-box; display: block; margin-inline: 0px; overflow-x: auto; scrollbar-color: rgba(121, 121, 121, 0.4) rgba(0, 0, 0, 0); scrollbar-width: thin;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;const&lt;/span&gt; (&lt;br/&gt;    SystemType_Base SystemType = &lt;span class=&quot;hljs-literal&quot; style=&quot;box-sizing: border-box; color: rgb(121, 192, 255);&quot;&gt;iota&lt;/span&gt;&lt;br/&gt;    &lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box; color: rgb(139, 148, 158);&quot;&gt;// ... 现有系统类型&lt;/span&gt;&lt;br/&gt;    SystemType_TownInventory &lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box; color: rgb(139, 148, 158);&quot;&gt;// 小镇背包系统&lt;/span&gt;&lt;br/&gt;    SystemType_MAX&lt;br/&gt;)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&quot;2&quot; style=&quot;box-sizing: border-box; margin: 0px 0px 12px; list-style-position: initial; list-style-image: initial; padding: 0px 0px 0px 18px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; font-size: 13px; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;&lt;li style=&quot;box-sizing: border-box; margin-bottom: 4px;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;创建System实现文件&lt;/strong&gt;（例如&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;internal/ecs/system/town_inventory/town_inventory.go&lt;/code&gt;&amp;nbsp;）：&lt;/li&gt;&lt;/ol&gt;&lt;div class=&quot;markdown-pre-container&quot; style=&quot;box-sizing: border-box; border-color: color(srgb 0.8 0.8 0.8 / 0.12); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; margin-block: 12px; border-radius: 4px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; font-size: 13px; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;&lt;div class=&quot;markdown-pre__header&quot; style=&quot;box-sizing: border-box; background-color: rgb(30, 30, 30); align-items: center; border-radius: 4px 4px 0px 0px; display: flex; gap: 8px; justify-content: space-between; padding: 6px 12px; position: sticky; top: 0px; z-index: 1;&quot;&gt;&lt;span class=&quot;markdown-pre__title&quot; style=&quot;box-sizing: border-box; color: rgb(255, 255, 255); font-size: 12px; font-weight: 600; height: 18px; line-height: 18px; text-transform: capitalize;&quot;&gt;go&lt;/span&gt;&lt;div class=&quot;markdown-pre__actions&quot; style=&quot;box-sizing: border-box; align-items: center; color: rgb(204, 204, 204); display: flex; gap: 8px; line-height: 20px; overflow-x: hidden;&quot;&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;插入至光标处&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M4.73486 6.62196L6.11235 7.99945L4.73486 9.37693&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M6 8L1 8&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;rect x=&quot;6&quot; y=&quot;2&quot; width=&quot;8&quot; height=&quot;3&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/rect&gt;&lt;rect x=&quot;6&quot; y=&quot;11&quot; width=&quot;8&quot; height=&quot;3&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/rect&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;插入&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;复制&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M4.5 11.5C4.5 12.0523 4.94772 12.5 5.5 12.5H12C12.5523 12.5 13 12.0523 13 11.5V6.99299C13 6.44071 12.5523 5.99299 12 5.99299H9.9324C9.38012 5.99299 8.9324 5.54528 8.9324 4.99299V3C8.9324 2.44771 8.48469 2 7.9324 2H5.5C4.94772 2 4.5 2.44772 4.5 3V11.5Z&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M8.5293 2.19629L12.6563 6.22913&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M2.5 6.5V11.5C2.5 13.1569 3.84315 14.5 5.5 14.5H9.5&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;复制&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;新建文件&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M13 7.7V5L10.1875 2H3.625C3.27982 2 3 2.26863 3 2.6V13.4C3 13.7314 3.27982 14 3.625 14H7.375&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M9.4165 2V5.00011H12.9999&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.2085 9.5V14&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M13.4585 11.75L8.9585 11.75&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;新建文件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;保存到本地&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M13 7.7V5L10.1875 2H3.625C3.27982 2 3 2.26863 3 2.6V13.4C3 13.7314 3.27982 14 3.625 14H7.375&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M9.4165 2V5.00011H12.9999&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.2085 9.5V14&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.209 14L9.31982 12.1108&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.209 14L13.0981 12.1108&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;保存&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__divider&quot; style=&quot;box-sizing: border-box; border-left: 0.8px solid rgb(96, 96, 96); height: 16px; margin-left: 4px; padding-left: 4px;&quot;&gt;&lt;/div&gt;&lt;div title=&quot;应用代码&quot; class=&quot;markdown-pre__action&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M6.34856 4.97077C6.41299 4.79665 6.65927 4.79664 6.7237 4.97077L7.88659 8.11341L11.0292 9.2763C11.2034 9.34073 11.2034 9.58701 11.0292 9.65144L7.88659 10.8143L6.7237 13.957C6.65927 14.1311 6.41299 14.1311 6.34856 13.957L5.18568 10.8143L2.04303 9.65144C1.86891 9.58701 1.86891 9.34073 2.04303 9.2763L5.18568 8.11341L6.34856 4.97077Z&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M12.2662 1.53613L12.8599 3.14038L14.4641 3.73401L12.8599 4.32763L12.2662 5.93188L11.6726 4.32763L10.0684 3.73401L11.6726 3.14038L12.2662 1.53613Z&quot; fill=&quot;currentColor&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;0.975&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;应用代码&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M4.66663 13.333L7.99996 9.99967L11.3333 13.333&quot; stroke=&quot;currentColor&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M4.66663 2.66667L7.99996 6L11.3333 2.66667&quot; stroke=&quot;currentColor&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;pre class=&quot;markdown-pre has-scrollbar&quot; style=&quot;box-sizing: border-box; scrollbar-color: rgba(121, 121, 121, 0.4) rgba(0, 0, 0, 0); scrollbar-width: thin; border-top: none; margin: 0px; overflow: auto; --mermaid-block-height: 360px; border-radius: 0px 0px 4px 4px;&quot;&gt;&lt;code class=&quot;hljs language-go&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; color: rgb(201, 209, 217); background-color: inherit; padding: 6px 12px; border-radius: 0px; box-sizing: border-box; display: block; margin-inline: 0px; overflow-x: auto; scrollbar-color: rgba(121, 121, 121, 0.4) rgba(0, 0, 0, 0); scrollbar-width: thin;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;package&lt;/span&gt; town_inventory&lt;br/&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;import&lt;/span&gt; (&lt;br/&gt;    &lt;span class=&quot;hljs-string&quot; style=&quot;box-sizing: border-box; color: rgb(165, 214, 255);&quot;&gt;&quot;mp/servers/scene_server/internal/common&quot;&lt;/span&gt;&lt;br/&gt;    &lt;span class=&quot;hljs-string&quot; style=&quot;box-sizing: border-box; color: rgb(165, 214, 255);&quot;&gt;&quot;mp/servers/scene_server/internal/ecs/system&quot;&lt;/span&gt;&lt;br/&gt;)&lt;br/&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;type&lt;/span&gt; townInventorySystem &lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;struct&lt;/span&gt; {&lt;br/&gt;    *system.SystemBase&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;hljs-title&quot; style=&quot;box-sizing: border-box; color: rgb(210, 168, 255);&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(scene common.Scene)&lt;/span&gt;&lt;/span&gt; common.System {&lt;br/&gt;    &lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;return&lt;/span&gt; &amp;amp;townInventorySystem{&lt;br/&gt;        SystemBase: system.New(scene),&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(s *townInventorySystem)&lt;/span&gt;&lt;/span&gt; Type() common.SystemType {&lt;br/&gt;    &lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;return&lt;/span&gt; common.SystemType_TownInventory&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(s *townInventorySystem)&lt;/span&gt;&lt;/span&gt; Update() {&lt;br/&gt;    &lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box; color: rgb(139, 148, 158);&quot;&gt;// 实现定期检查逻辑，例如检查物品过期&lt;/span&gt;&lt;br/&gt;    &lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box; color: rgb(139, 148, 158);&quot;&gt;// 获取所有拥有TownInventoryComp的实体并处理&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(s *townInventorySystem)&lt;/span&gt;&lt;/span&gt; OnMsg(msg any) &lt;span class=&quot;hljs-type&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;error&lt;/span&gt; {&lt;br/&gt;    &lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box; color: rgb(139, 148, 158);&quot;&gt;// 处理相关消息&lt;/span&gt;&lt;br/&gt;    &lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot; style=&quot;box-sizing: border-box; color: rgb(121, 192, 255);&quot;&gt;nil&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&quot;3&quot; style=&quot;box-sizing: border-box; margin: 0px 0px 12px; list-style-position: initial; list-style-image: initial; padding: 0px 0px 0px 18px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; font-size: 13px; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;&lt;li style=&quot;box-sizing: border-box; margin-bottom: 4px;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;在场景初始化时添加System&lt;/strong&gt;： 在&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;scene_impl.go&lt;/code&gt;&amp;nbsp;的&amp;nbsp;&lt;code class=&quot;&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; background-color: rgba(228, 230, 241, 0.15); padding: 1px 3px; border-radius: 3px; box-sizing: border-box; padding-inline: 4px; pointer-events: none;&quot;&gt;initSystem&lt;/code&gt;&amp;nbsp;方法中添加：&lt;/li&gt;&lt;/ol&gt;&lt;div class=&quot;markdown-pre-container&quot; style=&quot;box-sizing: border-box; border-color: color(srgb 0.8 0.8 0.8 / 0.12); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; margin-block: 12px; border-radius: 4px; color: rgb(212, 212, 212); font-family: Inter, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI (Custom)&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Open Sans (Custom)&amp;quot;, system-ui, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;; font-size: 13px; text-align: start; background-color: rgb(37, 37, 38);&quot;&gt;&lt;div class=&quot;markdown-pre__header&quot; style=&quot;box-sizing: border-box; background-color: rgb(30, 30, 30); align-items: center; border-radius: 4px 4px 0px 0px; display: flex; gap: 8px; justify-content: space-between; padding: 6px 12px; position: sticky; top: 0px; z-index: 1;&quot;&gt;&lt;span class=&quot;markdown-pre__title&quot; style=&quot;box-sizing: border-box; color: rgb(255, 255, 255); font-size: 12px; font-weight: 600; height: 18px; line-height: 18px; text-transform: capitalize;&quot;&gt;go&lt;/span&gt;&lt;div class=&quot;markdown-pre__actions&quot; style=&quot;box-sizing: border-box; align-items: center; color: rgb(204, 204, 204); display: flex; gap: 8px; line-height: 20px; overflow-x: hidden;&quot;&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;插入至光标处&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M4.73486 6.62196L6.11235 7.99945L4.73486 9.37693&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M6 8L1 8&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;rect x=&quot;6&quot; y=&quot;2&quot; width=&quot;8&quot; height=&quot;3&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/rect&gt;&lt;rect x=&quot;6&quot; y=&quot;11&quot; width=&quot;8&quot; height=&quot;3&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/rect&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;插入&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;复制&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M4.5 11.5C4.5 12.0523 4.94772 12.5 5.5 12.5H12C12.5523 12.5 13 12.0523 13 11.5V6.99299C13 6.44071 12.5523 5.99299 12 5.99299H9.9324C9.38012 5.99299 8.9324 5.54528 8.9324 4.99299V3C8.9324 2.44771 8.48469 2 7.9324 2H5.5C4.94772 2 4.5 2.44772 4.5 3V11.5Z&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M8.5293 2.19629L12.6563 6.22913&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M2.5 6.5V11.5C2.5 13.1569 3.84315 14.5 5.5 14.5H9.5&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;复制&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;新建文件&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M13 7.7V5L10.1875 2H3.625C3.27982 2 3 2.26863 3 2.6V13.4C3 13.7314 3.27982 14 3.625 14H7.375&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M9.4165 2V5.00011H12.9999&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.2085 9.5V14&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M13.4585 11.75L8.9585 11.75&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;新建文件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; title=&quot;保存到本地&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M13 7.7V5L10.1875 2H3.625C3.27982 2 3 2.26863 3 2.6V13.4C3 13.7314 3.27982 14 3.625 14H7.375&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M9.4165 2V5.00011H12.9999&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.2085 9.5V14&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.209 14L9.31982 12.1108&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M11.209 14L13.0981 12.1108&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;保存&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__divider&quot; style=&quot;box-sizing: border-box; border-left: 0.8px solid rgb(96, 96, 96); height: 16px; margin-left: 4px; padding-left: 4px;&quot;&gt;&lt;/div&gt;&lt;div title=&quot;应用代码&quot; class=&quot;markdown-pre__action&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M6.34856 4.97077C6.41299 4.79665 6.65927 4.79664 6.7237 4.97077L7.88659 8.11341L11.0292 9.2763C11.2034 9.34073 11.2034 9.58701 11.0292 9.65144L7.88659 10.8143L6.7237 13.957C6.65927 14.1311 6.41299 14.1311 6.34856 13.957L5.18568 10.8143L2.04303 9.65144C1.86891 9.58701 1.86891 9.34073 2.04303 9.2763L5.18568 8.11341L6.34856 4.97077Z&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;1.3&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M12.2662 1.53613L12.8599 3.14038L14.4641 3.73401L12.8599 4.32763L12.2662 5.93188L11.6726 4.32763L10.0684 3.73401L11.6726 3.14038L12.2662 1.53613Z&quot; fill=&quot;currentColor&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;0.975&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span class=&quot;markdown-pre__label&quot; style=&quot;box-sizing: border-box; display: block; text-wrap-mode: nowrap;&quot;&gt;应用代码&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;markdown-pre__action&quot; style=&quot;box-sizing: border-box; align-items: center; cursor: pointer; display: flex; gap: 4px; justify-content: center; opacity: 0.7; padding: 4px; padding-inline: 4px;&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;16&quot; height=&quot;16&quot; viewBox=&quot;0 0 16 16&quot; fill=&quot;none&quot; class=&quot;markdown-pre__icon&quot;&gt;&lt;path d=&quot;M4.66663 13.333L7.99996 9.99967L11.3333 13.333&quot; stroke=&quot;currentColor&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M4.66663 2.66667L7.99996 6L11.3333 2.66667&quot; stroke=&quot;currentColor&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;pre class=&quot;markdown-pre has-scrollbar&quot; style=&quot;box-sizing: border-box; scrollbar-color: rgba(121, 121, 121, 0.4) rgba(0, 0, 0, 0); scrollbar-width: thin; border-top: none; margin: 0px; overflow: auto; --mermaid-block-height: 360px; border-radius: 0px 0px 4px 4px;&quot;&gt;&lt;code class=&quot;hljs language-go&quot; style=&quot;font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; color: rgb(201, 209, 217); background-color: inherit; padding: 6px 12px; border-radius: 0px; box-sizing: border-box; display: block; margin-inline: 0px; overflow-x: auto; scrollbar-color: rgba(121, 121, 121, 0.4) rgba(0, 0, 0, 0); scrollbar-width: thin;&quot;&gt;&lt;span class=&quot;hljs-function&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;hljs-params&quot; style=&quot;box-sizing: border-box;&quot;&gt;(s *scene)&lt;/span&gt;&lt;/span&gt; initSystem() &lt;span class=&quot;hljs-type&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;error&lt;/span&gt; {&lt;br/&gt;    &lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: border-box; color: rgb(139, 148, 158);&quot;&gt;// ... 现有系统初始化代码&lt;/span&gt;&lt;br/&gt;    townInventorySystem := town_inventory.New(s)&lt;br/&gt;    err = s.AddSystem(townInventorySystem)&lt;br/&gt;    &lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;if&lt;/span&gt; err != &lt;span class=&quot;hljs-literal&quot; style=&quot;box-sizing: border-box; color: rgb(121, 192, 255);&quot;&gt;nil&lt;/span&gt; {&lt;br/&gt;        &lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;return&lt;/span&gt; errors.New(&lt;span class=&quot;hljs-string&quot; style=&quot;box-sizing: border-box; color: rgb(165, 214, 255);&quot;&gt;&quot;add town inventory system error: &quot;&lt;/span&gt; + err.Error())&lt;br/&gt;    }&lt;br/&gt;    &lt;span class=&quot;hljs-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(255, 123, 114);&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot; style=&quot;box-sizing: border-box; color: rgb(121, 192, 255);&quot;&gt;nil&lt;/span&gt;&lt;br/&gt;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="1055" width="620" x="790" y="90" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-12" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-11" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-10" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="设置脏标记" vertex="1">
          <mxGeometry height="60" width="120" x="160" y="800" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-14" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-13" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-11" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="每个tick存盘" vertex="1">
          <mxGeometry height="60" width="120" x="160" y="940" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-13" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="具体怎么存？" vertex="1">
          <mxGeometry height="60" width="120" x="160" y="1080" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-18" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-17" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-24" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-23" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-15" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="客户端同步" vertex="1">
          <mxGeometry height="60" width="120" x="90" y="1340" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-16" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="存盘" vertex="1">
          <mxGeometry height="60" width="120" x="1430" y="1340" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-20" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-19" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-17" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="帧同步" vertex="1">
          <mxGeometry height="60" width="120" x="-120" y="1430" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-28" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-27" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-19" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="&lt;div&gt;帧同步协议&lt;/div&gt;FrameDataUpdate&amp;nbsp;" vertex="1">
          <mxGeometry height="60" width="120" x="-120" y="1570" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-21" parent="1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;dashed=1;" value="" vertex="1">
          <mxGeometry height="260" width="240" x="-180" y="1390" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-22" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="NetUpdateSystem&amp;nbsp;" vertex="1">
          <mxGeometry height="30" width="60" x="-160" y="1390" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-26" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-25" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-23" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="数据变化时脏标记&lt;div&gt;帧同步&lt;/div&gt;" vertex="1">
          <mxGeometry height="60" width="120" x="340" y="1430" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-30" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-29" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-25" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="UserDataProto&amp;nbsp;" vertex="1">
          <mxGeometry height="60" width="120" x="340" y="1570" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-32" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-31" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-34" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-33" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-27" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="&lt;div&gt;场景中（视野内/订阅列表）&lt;/div&gt;&lt;div&gt;所有公共数据&lt;/div&gt;" vertex="1">
          <mxGeometry height="60" width="120" x="-120" y="1710" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-29" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="玩家个人私有数据" vertex="1">
          <mxGeometry height="60" width="120" x="340" y="1710" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-36" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-35" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-31" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="UpdateFrameChange&amp;nbsp;" vertex="1">
          <mxGeometry height="60" width="120" x="-270" y="1790" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-37" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="YhBxXAwAqzDYDqpHPoga-35">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-33" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="UpdateFrameAll&amp;nbsp;" vertex="1">
          <mxGeometry height="60" width="120" x="30" y="1790" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-35" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="例如位置，动作等" vertex="1">
          <mxGeometry height="60" width="120" x="-120" y="1930" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-40" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-38" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-39" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-42" edge="1" parent="1" source="YhBxXAwAqzDYDqpHPoga-38" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="YhBxXAwAqzDYDqpHPoga-41" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-38" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="特征值面板" vertex="1">
          <mxGeometry height="60" width="120" x="-120" y="2060" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-39" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="外部系统修改" vertex="1">
          <mxGeometry height="60" width="120" x="-320" y="2060" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-41" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="内部状态读取" vertex="1">
          <mxGeometry height="60" width="120" x="80" y="2060" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-48" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="scene" vertex="1">
          <mxGeometry height="60" width="120" x="1930" y="1080" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-49" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="res" vertex="1">
          <mxGeometry height="60" width="120" x="2200" y="1070" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-58" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="entity" vertex="1">
          <mxGeometry height="60" width="120" x="2200" y="1169" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-60" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="system" vertex="1">
          <mxGeometry height="60" width="120" x="2200" y="920" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-63" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2070" y="1100" as="sourcePoint" />
            <mxPoint x="2180" y="1100" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-64" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2070" y="1130" as="sourcePoint" />
            <mxPoint x="2190" y="1200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-65" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="net_func" vertex="1">
          <mxGeometry height="60" width="120" x="2200" y="1270" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-66" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2050" y="1160" as="sourcePoint" />
            <mxPoint x="2198" y="1300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-67" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="comp" vertex="1">
          <mxGeometry height="60" width="120" x="2450" y="850" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-69" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="res" vertex="1">
          <mxGeometry height="60" width="120" x="2450" y="980" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-71" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2330" y="930" as="sourcePoint" />
            <mxPoint x="2430" y="880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-72" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2330" y="980" as="sourcePoint" />
            <mxPoint x="2440" y="1010" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-74" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2581" y="1010" as="sourcePoint" />
            <mxPoint x="2640" y="1010" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-75" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="res" vertex="1">
          <mxGeometry height="60" width="120" x="2465" y="1180" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-76" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="comp" vertex="1">
          <mxGeometry height="60" width="120" x="2465" y="1260" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-77" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="entity" vertex="1">
          <mxGeometry height="60" width="120" x="2465" y="1350" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-78" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2330" y="1270" as="sourcePoint" />
            <mxPoint x="2430" y="1230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-79" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2330" y="1300" as="sourcePoint" />
            <mxPoint x="2450" y="1290" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-81" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2340" y="1320" as="sourcePoint" />
            <mxPoint x="2450" y="1370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-82" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="comp" vertex="1">
          <mxGeometry height="60" width="120" x="2650" y="980" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-83" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2060" y="1070" as="sourcePoint" />
            <mxPoint x="2190" y="980" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-84" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="comp" vertex="1">
          <mxGeometry height="60" width="120" x="2465" y="1070" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-85" edge="1" parent="1" style="endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2340" y="1100" as="sourcePoint" />
            <mxPoint x="2440" y="1100" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-86" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="common&lt;div&gt;定义了公共接口&lt;/div&gt;" vertex="1">
          <mxGeometry height="590" width="120" x="2910" y="830" as="geometry" />
        </mxCell>
        <mxCell id="YhBxXAwAqzDYDqpHPoga-87" edge="1" parent="1" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="2790" y="1090" as="sourcePoint" />
            <mxPoint x="2870" y="1090" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OBkMHbPbV-gv1om2fZDj-1" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="这个箭头表示，哪些部分可以调用另一部分，例如system可以调用component,&lt;div&gt;common是最上层，无法直接调用其他各个模块&lt;/div&gt;" vertex="1">
          <mxGeometry height="30" width="440" x="2310" y="1470" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
